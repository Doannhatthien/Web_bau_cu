<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªá Th·ªëng B·∫ßu C·ª≠ L·ªõp - Blockchain</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üó≥Ô∏è H·ªá Th·ªëng B·∫ßu C·ª≠ L·ªõp Online</h1>
            <p class="subtitle">D·ª±a tr√™n c√¥ng ngh·ªá Blockchain - Minh b·∫°ch & B·∫£o m·∫≠t</p>
            
            <!-- Th√¥ng tin ng∆∞·ªùi d√πng -->
            <div class="user-info" id="userInfo" style="display: none;">
                <div class="user-details">
                    <div class="user-avatar">üë§</div>
                    <div class="user-text">
                        <h3 id="userName">-</h3>
                        <p id="userRole">-</p>
                    </div>
                </div>
                <button class="logout-btn" id="logoutBtn">ƒêƒÉng xu·∫•t</button>
            </div>
        </header>

        <!-- Th√¥ng tin k·∫øt n·ªëi -->
        <div class="connection-status" id="connectionStatus">
            <div class="status-item">
                <span>Tr·∫°ng th√°i:</span>
                <span id="statusText" class="status-disconnected">Ch∆∞a k·∫øt n·ªëi</span>
            </div>
            <div class="status-item">
                <span>ƒê·ªãa ch·ªâ v√≠:</span>
                <span id="accountAddress">Ch∆∞a k·∫øt n·ªëi</span>
            </div>
            <div class="status-item">
                <span>Vai tr√≤:</span>
                <span id="userRole">-</span>
            </div>
        </div>

        <button id="connectWallet" class="btn btn-primary btn-large">K·∫øt n·ªëi MetaMask</button>

        <!-- Tab Navigation -->
        <div class="tabs" id="tabs" style="display: none;">
            <button class="tab-button active" data-tab="voting">B·ªè Phi·∫øu</button>
            <button class="tab-button" data-tab="results">K·∫øt Qu·∫£</button>
            <button class="tab-button" data-tab="registration">ƒêƒÉng K√Ω ·ª®ng Vi√™n</button>
            <button class="tab-button admin-only" data-tab="admin">Qu·∫£n Tr·ªã</button>
        </div>

        <!-- Voting Tab -->
        <div class="tab-content active" id="voting">
            <div class="section">
                <h2>üéØ Th√¥ng Tin B·∫ßu C·ª≠</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <h3>Tr·∫°ng th√°i b·∫ßu c·ª≠</h3>
                        <p id="electionState" class="state-text">-</p>
                    </div>
                    <div class="info-card">
                        <h3>S·ªë ·ª©ng vi√™n</h3>
                        <p id="candidateCount" class="count-text">0</p>
                    </div>
                    <div class="info-card">
                        <h3>T·ªïng s·ªë phi·∫øu</h3>
                        <p id="totalVotes" class="count-text">0</p>
                    </div>
                    <div class="info-card">
                        <h3>Tr·∫°ng th√°i c·ªßa b·∫°n</h3>
                        <p id="voterStatus" class="status-text">-</p>
                    </div>
                </div>
            </div>

            <div class="section">
                <h2>üë• Danh S√°ch ·ª®ng Vi√™n</h2>
                <div id="candidatesList" class="candidates-list">
                    <p class="empty-state">Ch∆∞a c√≥ ·ª©ng vi√™n n√†o</p>
                </div>
            </div>
        </div>

        <!-- Results Tab -->
        <div class="tab-content" id="results">
            <div class="section">
                <h2>üìä K·∫øt Qu·∫£ B·∫ßu C·ª≠</h2>
                <button id="refreshResults" class="btn btn-secondary">L√†m m·ªõi k·∫øt qu·∫£</button>
                <div id="resultsList" class="results-list">
                    <p class="empty-state">Ch∆∞a c√≥ k·∫øt qu·∫£</p>
                </div>
            </div>

            <div class="section">
                <h2>üìà Bi·ªÉu ƒê·ªì K·∫øt Qu·∫£</h2>
                <canvas id="resultsChart"></canvas>
            </div>
        </div>

        <!-- Registration Tab -->
        <div class="tab-content" id="registration">
            <div class="section">
                <h2>üìù ƒêƒÉng K√Ω ·ª®ng Vi√™n</h2>
                <p class="description">ƒêƒÉng k√Ω tham gia ·ª©ng c·ª≠ v√†o ban c√°n s·ª± l·ªõp</p>
                
                <form id="candidateForm" class="form">
                    <div class="form-group">
                        <label for="candidateName">H·ªç v√† t√™n:</label>
                        <input type="text" id="candidateName" placeholder="Nh·∫≠p h·ªç t√™n ƒë·∫ßy ƒë·ªß" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="candidatePosition">V·ªã tr√≠ ·ª©ng c·ª≠:</label>
                        <select id="candidatePosition" required>
                            <option value="">-- Ch·ªçn v·ªã tr√≠ --</option>
                            <option value="Lop truong">L·ªõp tr∆∞·ªüng</option>
                            <option value="Lop pho">L·ªõp ph√≥</option>
                            <option value="Bi thu">B√≠ th∆∞</option>
                            <option value="Uyen van">·ª¶y vi√™n vƒÉn ngh·ªá</option>
                            <option value="Hoc van">·ª¶y vi√™n h·ªçc v·∫•n</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn btn-success">ƒêƒÉng k√Ω ·ª©ng c·ª≠</button>
                </form>
            </div>

            <div class="section">
                <h2>üìã Quy ƒê·ªãnh Ban C√°n S·ª± L·ªõp</h2>
                <div class="positions-list" id="positionsList">
                    <div class="position-item">
                        <strong>L·ªõp tr∆∞·ªüng:</strong> ƒêi·ªÅu h√†nh ho·∫°t ƒë·ªông l·ªõp, ƒë·∫°i di·ªán l·ªõp
                    </div>
                    <div class="position-item">
                        <strong>L·ªõp ph√≥:</strong> H·ªó tr·ª£ l·ªõp tr∆∞·ªüng, ph·ª• tr√°ch chuy√™n c·∫ßn
                    </div>
                    <div class="position-item">
                        <strong>B√≠ th∆∞:</strong> C√¥ng t√°c ƒêo√†n, phong tr√†o
                    </div>
                    <div class="position-item">
                        <strong>·ª¶y vi√™n vƒÉn ngh·ªá:</strong> T·ªï ch·ª©c ho·∫°t ƒë·ªông vƒÉn h√≥a, vƒÉn ngh·ªá
                    </div>
                    <div class="position-item">
                        <strong>·ª¶y vi√™n h·ªçc v·∫•n:</strong> Theo d√µi k·∫øt qu·∫£ h·ªçc t·∫≠p, t·ªï ch·ª©c h·ªçc nh√≥m
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Tab -->
        <div class="tab-content admin-only" id="admin">
            <div class="section">
                <h2>‚öôÔ∏è Qu·∫£n Tr·ªã H·ªá Th·ªëng</h2>
                
                <div class="admin-panel">
                    <div class="admin-section">
                        <h3>ƒêƒÉng k√Ω c·ª≠ tri</h3>
                        <div class="form-group">
                            <label for="voterAddress">ƒê·ªãa ch·ªâ v√≠ c·ª≠ tri:</label>
                            <input type="text" id="voterAddress" placeholder="0x...">
                        </div>
                        <button id="registerVoter" class="btn btn-primary">ƒêƒÉng k√Ω c·ª≠ tri</button>
                    </div>

                    <div class="admin-section">
                        <h3>ƒêƒÉng k√Ω nhi·ªÅu c·ª≠ tri</h3>
                        <div class="form-group">
                            <label for="voterAddresses">Danh s√°ch ƒë·ªãa ch·ªâ (m·ªói ƒë·ªãa ch·ªâ m·ªôt d√≤ng):</label>
                            <textarea id="voterAddresses" rows="5" placeholder="0x...&#10;0x...&#10;0x..."></textarea>
                        </div>
                        <button id="registerMultipleVoters" class="btn btn-primary">ƒêƒÉng k√Ω nhi·ªÅu c·ª≠ tri</button>
                    </div>

                    <div class="admin-section">
                        <h3>Th√™m ·ª©ng vi√™n th·ªß c√¥ng</h3>
                        <div class="form-group">
                            <label for="adminCandidateName">H·ªç t√™n:</label>
                            <input type="text" id="adminCandidateName" placeholder="Nguy·ªÖn VƒÉn A">
                        </div>
                        <div class="form-group">
                            <label for="adminCandidatePosition">V·ªã tr√≠:</label>
                            <select id="adminCandidatePosition">
                                <option value="Lop truong">L·ªõp tr∆∞·ªüng</option>
                                <option value="Lop pho">L·ªõp ph√≥</option>
                                <option value="Bi thu">B√≠ th∆∞</option>
                                <option value="Uyen van">·ª¶y vi√™n vƒÉn ngh·ªá</option>
                                <option value="Hoc van">·ª¶y vi√™n h·ªçc v·∫•n</option>
                            </select>
                        </div>
                        <button id="addCandidate" class="btn btn-success">Th√™m ·ª©ng vi√™n</button>
                    </div>

                    <div class="admin-section">
                        <h3>ƒêi·ªÅu khi·ªÉn b·∫ßu c·ª≠</h3>
                        <div class="button-group">
                            <button id="startRegistration" class="btn btn-warning">B·∫Øt ƒë·∫ßu ƒëƒÉng k√Ω ·ª©ng vi√™n</button>
                            <button id="startVoting" class="btn btn-success">B·∫Øt ƒë·∫ßu b·ªè phi·∫øu</button>
                            <button id="endElection" class="btn btn-danger">K·∫øt th√∫c b·∫ßu c·ª≠</button>
                            <button id="resetElection" class="btn btn-secondary">Reset h·ªá th·ªëng</button>
                        </div>
                    </div>

                    <div class="admin-section">
                        <h3>Th√™m v·ªã tr√≠ t√πy ch·ªânh</h3>
                        <div class="form-group">
                            <label for="customPosition">T√™n v·ªã tr√≠:</label>
                            <input type="text" id="customPosition" placeholder="V√≠ d·ª•: Th·ªß qu·ªπ">
                        </div>
                        <button id="addPosition" class="btn btn-info">Th√™m v·ªã tr√≠</button>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>¬© 2025 - H·ªá Th·ªëng B·∫ßu C·ª≠ L·ªõp Blockchain | Ph√°t tri·ªÉn v·ªõi Ethereum & Solidity</p>
        </footer>
    </div>

    <!-- Loading overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner"></div>
        <p>ƒêang x·ª≠ l√Ω...</p>
    </div>

    <!-- Scripts -->
    <script>
        // T·∫Øt c·∫£nh b√°o source map trong console
        const originalConsoleError = console.error;
        console.error = function(...args) {
            const errorString = args.join(' ');
            if (errorString.includes('source map') || errorString.includes('ENOENT')) {
                return; // B·ªè qua l·ªói source map
            }
            originalConsoleError.apply(console, args);
        };
        
        const originalConsoleWarn = console.warn;
        console.warn = function(...args) {
            const warnString = args.join(' ');
            if (warnString.includes('source map') || warnString.includes('ENOENT')) {
                return; // B·ªè qua c·∫£nh b√°o source map
            }
            originalConsoleWarn.apply(console, args);
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="auth.js"></script>
    <script src="app.js"></script>
</body>
</html>
